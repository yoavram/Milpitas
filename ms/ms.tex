\magnification=1170
\hsize=6.5truein
\hoffset=.05truein
%\vsize=8.5truein
%\voffset=.25truein
\hfuzz=14pt
\parskip=5pt
\baselineskip=16pt

\def\harr#1#2{\smash{\mathop{\hbox to .2in{\rightarrowfill}}\limits^{\scriptstyle#1}_{\scriptstyle#2}}}

\def\var{\varepsilon}

\def\ref{\par\noindent\hangindent.35truein}

\def\cl{\hbox{\tenbf L}}
\def\ci{\hbox{\tenbf I}}


\font\tit=cmbx10 at 14pt
\ \vskip1.1in
\centerline{\tit Vertical and Oblique Transmission under}\smallskip
\centerline{\tit Fluctuating Selection}
\vskip.3in


\centerline{Yoav Ram$^1$, Uri Liberman$^{2}$, and Marcus W. Feldman$^1$}


\vskip.5truein

%\centerline{$*$ Corresponding author}
\bigskip
\centerline{$^1$Department of Biology}
%\vskip-7pt
\centerline{Stanford University}
%\vskip-7pt
\centerline{Stanford, CA 94305-5020}
\bigskip

\centerline{$^2$School of Mathematical Sciences}
%\vskip-7pt
\centerline{Tel Aviv University}
%\vskip-7pt
\centerline{Tel Aviv, Israel 69978}
%\vskip-7pt
%\centerline{uril@tauex.tau.ac.il}
\vfil
\centerline{August 25, 2017, v.2}

\break
\noindent{\bf INTRODUCTION}
\smallskip

Cavalli-Sforza and Feldman (1981) distinguished two forms of non-parental phenotypic transmission in the context of cultural evolution. Horizontal transmission  occurs when a trait is passed between members of the same generation and is analogous to transmission of an infectious agent. Oblique transmission to offspring is from non-parental members of the parental generation. Evolution under either of these is expected to be more rapid than under purely vertical, i.e., parent-to-offspring, transmission (Lycett and Gowlett 2008; Bergstrom and Dugatkin 2012, Ch. 19.4).

Oblique transmission occurs via some mechanism of social learning, which may include imitation or active teaching. There has been an interesting debate over the past thirty years concerning the conditions under which social learning would have an advantage over individual learning or vertical (including genetic) transmission. This debate is usually couched in terms of the mode and tempo of environmental fluctuations that would affect fitness and hence evolution (Rogers 1988; Boyd and Richerson 1988, 1995; Feldman et al. 1996; Wakano et al. 2004: Aoki et al. 2005; Wakano and Aoki 2007; Aoki and Feldman 2014). Mathematical analyses of models of competition between individual and social learning have generally shown that social learning has an advantage when the environment does not fluctuate too frequently. On the other hand, when the environmental changes are very frequent, individual learning is favored, while innate (genetic) determination of the trait does best when periods between environmental change are long on average.

In some situations, oblique transmission of biological material is possible. In bacteria, phenotypes might be determined by heritable mobile genetic elements such as phages (Zinder and Lederberg 1952), plasmids (Lederberg and Tatum 1946), integrons (Mazel 2006), and transposons (Salyers et al.\ 2004). Similarly, some phenotypes are determined by genes that are commonly converted by uptake of foreign DNA, i.e., transformation (Milkman and Bridges 1990). In these cases, inheritance of a phenotype may combine vertical transmission from the parent cell, and oblique transmission from other cells, even if the latter did not originally evolve for that purpose (Redfield 1993). 

In some animals, transmission of microbes occasioned by the sharing or manipulation of food or other consumable resources during a social interaction. Although transmission of the microbiome in humans is likely to be mostly vertical (Rosenberg and Zilber-Rosenberg 2016), in other organisms there is multi-generational food sharing during which symbionts from the parental cohort may be transmitted obliquely to younger individuals (Theis et al.\ 2016). In such cases, fluctuations in the resource type or availability may have fitness effects that depend on features of the transmitted microbiome. This ecological perspective on community transmission is stressed by van Opstal and Bordenstein (2015), who emphasize the ``need to consider the relative roles of vertical and horizontal transmission of microbial communities.''

Another perspective on the evolutionary consequences of fluctuating environments (and, as a result, fluctuating fitnesses) has derived from the phenomenon of phenotypic switching (Balaban et al.\ 2004; Kussell and Leibler 2005; Thattai and van Oudenaarden 2004; Salath\'e et al.\ 2009; Liberman et al.\ 2011; Gaal et al.\ 2010). In these studies, mutation caused the organism to switch phenotypes (usually treated as haploid genotypes), and the problem has usually been posed in terms of the optimal rate of mutation when the phenotypic fitnesses fluctuate over time. These models did not include social learning, and the evolution was regarded as a mode of bet-hedging against future environmental change. Optimal (that is, evolutionarily stable) mutation rates depend on many features of the fluctuations, for example,  degree of fitness symmetry, strength of selection, and variance in the period of fluctuation (Salath\'e et al.\ 2009).

In a recent analysis of evolution in fluctuating environments, Xue and Leibler (2016) allowed an organism to absorb information about the distribution of possible environments by learning the phenotypes of members of its parental lineage from previous generations. They describe this as ``positive feedback that enhances the probability of the offspring to express the same phenotype as the parent.'' In this formulation there was ``reinforcement of the parent phenotype'' in an offspring, such as might occur through epigenetic inheritance. Although their analysis was not couched in terms of oblique and vertical transmission, as defined by Cavalli-Sforza and Feldman (1981), we have been stimulated by their analysis to develop a model in which oblique transmission, at a rate dependent on the trait frequency in the parental generation, occurs in addition to classical vertical transmission. We then ask how fluctuations in fitnesses interact with the rate of oblique transmission to affect evolutionary dynamics and how the rate of oblique transmission itself might evolve. 

In our formulation, both the parental phenotype and the distribution of phenotypes in the whole population contribute to an offspring's phenotype. Using conventional modifier theory (Feldman and Liberman 1986), we show that in a cyclic selection regime with cycles of periods 1 or 2, an allele reducing the rate of vertical transmission is expected to increase in frequency when rare and in so doing to increase the mean fitness of the population. However, for cycles of greater length, interesting non-monotonicities emerge, both in the uninvadable rate of vertical transmission, and the rate that maximizes the geometric time average of the population mean fitness, which we will refer to as the ``geometric mean fitness.'' We develop the models in very large populations with cyclic selection and with random fitnesses and also in the case where drift occurs via sampling from generation to generation in a finite population.

\vfil\break


\noindent{\bf THE MODEL}
\smallskip

Consider an infinite population whose members are characterized by their phenotype $\phi$, which can be of two types $\phi=A$ or $\phi=B$, with associated frequencies $x$ and $(1-x)$, respectively. We follow the evolution of $x$ over discrete non-overlapping generations. In each generation individuals are subject to  selection where the fitnesses of $A$ and $B$ are $w_A$ and $w_B$, respectively.

An offspring inherits its phenotype from its parent via {\sl vertical transmission} with probability $\rho$ and from a random individual in the parental population via {\sl oblique transmission} with probability $(1-\rho)$. Therefore, given that the parent phenotype is $\phi$ and assuming {\sl uni-parental inheritance} (Zefferman 2016), the conditional probability that the phenotype $\phi'$ of the offspring is $A$ is
$$P(\phi' =A|\phi) =\left\{\matrix{(1-\rho)x+\rho &\hbox{\tenrm if}\ \phi=A\cr 
\noalign{\smallskip}
 (1-\rho)x & \hbox{\tenrm if}\ \phi =B\cr}\right.\eqno(1)$$
 where $x=P(\phi=A)$ in the parent's generation before selection.
 
 Therefore the frequency $x'$ of  phenotype $A$ after one generation is given by the recursion equation
 $$x'= \rho{w_Ax\over \overline w} +(1-\rho)x=     {w_A\over \overline w}x\bigl[(1-\rho)x +\rho\bigr] +{w_B\over \overline w}(1-x)\bigl[(1-\rho)x\bigr],\eqno(2)$$
 where $\overline w$ is the {\sl mean fitness}, namely
 $$\overline w=w_A x+w_B(1-x).\eqno(3)$$
 Equation (2) can be rewritten as
 $$x' =x\left[1+\rho(1-x){w_A-w_B\over \overline w}\right]    =x\cdot{x(1-\rho)(w_A-w_B) +\rho w_A +(1-\rho)w_B\over x(w_A-w_B) +w_B}.\eqno(4)$$
 
 In what follows we explore the evolution of the recursion (4), namely the equilibria and their stability properties, in the cases of {\sl constant environments} and {\sl changing environments}.
 \bigskip
 \bigskip

\noindent{\bf CONSTANT ENVIRONMENT}
\smallskip

When the environment is constant, the fitness parameters $w_A$ and $w_B$ do not change between generations, and we have the following result.

\proclaim Result 1. If $0<\rho\le 1$ and both $w_A$ and $w_B$ are positive with $w_A\ne w_B$, then fixation in the phenotype $A\ (B)$ is globally stable when $w_A>w_B$ $(w_A<w_B)$.\par

\noindent{\it Proof}.
If we rewrite (4) as $x'=x\cdot F(x)$, it can be seen that $F(1)=1$, and for $\rho>0$ and $0<x<1$
$$\eqalign{
&F(x)>1\quad\hbox{\tenrm when}\quad w_A>w_B,\cr
&F(x)<1\quad\hbox{\tenrm when}\quad w_A<w_B.}\eqno(5)$$
Hence, as $w_A>0$ and $w_B>0$, both fixations in $A$ or in $B$  ($x^*=1$ for fixation in $A$ and $x^*=0$ for fixation in $B$) are equilibrium points of (4). Moreover, if $x_t$ is the value of $x$ at the $t$-th generation $(t=0,1,2,\dots)$, from (4)  and (5) we have for any $0<x_0<1$ and all $t=0,1,2,\dots$,
$$\eqalign{
&x^{t+1}>x^t\quad\hbox{\tenrm when}\quad w_A>w_B,\cr
&x^{t+1}<x^t\quad\hbox{\tenrm when}\quad w_A<w_B.}\eqno(6)$$

\noindent Thus, as $x^*=1$ or $x^*=0$ are the only equilibrium points, then
$$\eqalign{
&\lim_{t\to\infty}x_t=1,\ \ \hbox{\tenrm for all}\ 0<x_0\le 1,\ \ \hbox{\tenrm when}\ w_A>w_B,\cr
&\lim_{t\to\infty}x_t=0,\ \ \hbox{\tenrm for all}\ 0\le x_0< 1,\ \ \hbox{\tenrm when}\ w_A<w_B.}\eqno(7)$$
Therefore fixation of the favored phenotype is globally stable, and ultimately all individuals have the favored phenotype.

If $\rho=0$ or $w_A=w_B>0$, the recursion (4) reduces to $x'=x$; the phenotype frequencies do not change over time.
With {\sl extreme selection},  for example $w_A=1$ and $w_B=0$ (or $w_B=1$ and $w_A=0$), recursion (4) reduces to
$x'=(1-\rho)x+\rho$, and therefore 
$x_t=1-(1-\rho)^t(1-x_0)$.
Hence, for $\rho>0$,  $x_t\,\harr{}{t\to\infty}\,1$ for all initial values $0\le x_0\le 1$, and  the favored phenotype fixes.
\bigskip
\bigskip

\noindent{\bf PERIODICALLY CHANGING ENVIRONMENT}
\smallskip

Next we consider the case where the environment is not constant but rather changes periodically, such that the favored phenotype changes after a fixed number of generations. Simple examples are $A1B1=ABABAB\dots$, in which the favored genotype switches every generation, or $A2B1=AABAABAAB\dots$, where every two generations in which selection favors $A$ are followed by a single generation in which selection favors $B$.
 
 In general, $AkBl$ denotes a selection regime in which the period is of $(k+l)$ generations with $k$ generations favoring phenotype $A$ followed by $l$ generations favoring $B$.
 
 Let $W$ be the fitness of the favored phenotype and $w$ be that of the other phenotype where $0<w<W$. Rewrite equation (4) as $x'=F_A(x)=xf_A(x)$ when $A$ is favored and $x'=F_B(x)=xf_B(x)$ when $B$ is favored. Then
  $$\eqalign{
  &f_A(x) = {x(1-\rho)(W-w) +\rho W +(1-\rho)w\over x(W-w) +w} = 1+\rho(1-x){W-w\over Wx +w(1-x)},\cr\noalign{\smallskip}
  &f_B(x) = {x(1-\rho)(w-W) +\rho w +(1-\rho)W\over x(w-W) +W} = 1+\rho(1-x){w-W\over wx+W(1-x)}.}\eqno(8)$$
  
  \noindent If $x_t$ denotes the frequency of exhibiting the phenotype $A$ at generation $t$ starting with $x_0$ initially, then as we are interested in the values of $x_t$ for $t=n(k+l)$ with $n=0,1,\dots$ at the end of complete periods then in fact
  $$x_{(n+1)(k+l)}=F(x_{n(k+l)}),\quad n=0,1,2,\dots,\eqno(9)$$
  where $F$ is the composed function
  $$F=\underbrace{F_B\circ F_B \circ\cdots\circ F_B}_{l\ \hbox{\sevenrm times}} \circ\underbrace{F_A\circ F_A \circ\cdots\circ F_A}_{k\ \hbox{\sevenrm times}}.\eqno(10)$$
  Clearly, since $F_A(0) =F_B(0) =0$ and $F_A(1) =F_B(1) =1$, both fixations in $A$ or in $B$ are equilibrium points. An interesting question is when these fixations are locally stable. We concentrate on $x^*=0$, the fixation of the phenotype $B$. As $x'=F_A(x) =xf_A(x)$ for $k$ generations and $x'=F_B(x) =xf_B(x)$ for $l$ generations, the linear approximation of $F(x)$ ``near'' $x=0$ is
   $$F(x) \simeq\bigl[f_A(0)\bigr]^k \bigl[f_B(0)\bigr]^lx.\eqno(11)$$
   Hence the local stability of $x^*=0$ is determined by the product $\bigl[f_A(0)\bigr]^k \bigl[f_B(0)\bigr]^l$, and $x^*=0$  is locally stable if this product  is less than 1 and unstable if it is larger than 1.
   
   From (8) we have
   $$\eqalign{
   &f_A(0) = 1+\rho{W-w\over w},\cr\noalign{\smallskip}
   &f_B(0) = 1+\rho{w-W\over W}.}\eqno(12)$$
   We start with the case $k=l$.
   
   \proclaim Result 2. If $k=l$ and $0<w<W$ with $0<\rho<1$, fixation of $B$ is unstable.\par
   
   \noindent {\it Proof.} The local stability of $x^*=0$, the fixation of $B$, is determined by the product
   $$\bigl[f_A(0)\bigr]^k \bigl[f_B(0)\bigr]^k=\left[\left(1+\rho{W-w\over w}\right)\left(1+\rho{w-W\over W}\right)\right]^k.\eqno(13)$$
   Observe that
   $$\eqalign{
   \left(1+\rho{W-w\over w}\right)\left(1+\rho{w-W\over W}\right) &= \left(1-\rho+\rho{W\over w}\right)\left(1-\rho+\rho{w\over W}\right)\cr
   &= \left(1-\rho\right)^2+ \rho^2 +\rho(1-\rho){W^2+w^2\over Ww}.}\eqno(14)$$
   Thus,
   $$\left(1+\rho{W-w\over w}\right)\left(1+\rho{w-W\over W}\right) =1+\rho(1-\rho){\left(W-w\right)^2\over wW}>1.\eqno(15)$$
   Since $0<\rho<1$ and $0<w<W$,  the $B$ fixation is unstable.
  \bigskip

\noindent{\it Conclusions}

\item{1.}As $k=l$ and the above result holds also when $0<W<w$, there is total symmetry between the two fixations in $A$ and $B$, and fixation in $A$ is not stable. Thus neither phenotype can become extinct, and we have a {\sl protected polymorphism} (Prout 1968).

\item{2.}Observe that for general $k$, $l$, the condition for local stability of fixation in $A$ is
$$\bigl[f_A(0)\bigr]^l \bigl[f_B(0)\bigr]^k <1, \eqno(16)$$
and that of $B$ is
$$\bigl[f_A(0)\bigr]^k \bigl[f_B(0)\bigr]^l <1. \eqno(17)$$
Therefore, following Result 2, 
$$\bigl[f_A(0)\bigr]^{k+l}\bigl[f_B(0)\bigr]^{k+l}>1,\eqno(18)$$
and it is impossible that both fixations are stable. Further, since by (12)  $f_A(0)>1$ and $0<f_B(0)<1$ when $0<w<W$, by choosing $k$ and $l$ appropriately, fixation on $A$ or fixation on $B$ (but not both) can be stable. In addition, we can have both fixations unstable giving the following result.

\proclaim Result 3. With $0<\rho<1$ and $0<w<W$ in the case of $AkBl$ periodically changing environments, both fixations may be unstable, producing a protected polymorphism.\par

\noindent{\it Proof}. Let $a=1+\rho{W-w\over w}$ and $b=1+\rho{w-W\over W}$. Then since $0<\rho <1$ and $0<w<W$, we have $a>1$ and $0<b<1$. Following (11), fixation in $B$ is not stable if $a^kb^l>1$, and similarly  fixation in $A$ is unstable if $a^lb^k>1$. Therefore both fixations are unstable if
$$a^kb^l>1\quad\hbox{\tenrm and}\quad a^lb^k>1,\eqno(19)$$
or equivalently if
$$k\log a +l\log b>0\quad\hbox{\tenrm and}\quad l\log a+k\log b>0.\eqno(20)$$
Now (20) holds if and only if
$$k\,{\log(1/b)\over\log a} < l < k\,{\log a\over\log(1/b)}.\eqno(21)$$ 
Inequalities (21) are consistent if and only if $\log(1/b)<\log a$, i.e., $ab>1$. But by (15),
$$ab=\left(1+\rho{W-w\over w}\right)\left(1+\rho{w-W\over W}\right)>1.\eqno(22)$$

\noindent{\it Remark}.
It should be pointed out that the local stability properties of the two fixations depend only on the fact that in a cycle of $(k+l)$ generations $A$ was favored $k$ times and $B$ was favored $l$ times, and not their order in the cycle.


When neither fixation in $A$ or $B$ is stable, we have a case of protected polymorphism, and we expect to have one or more polymorphic equilibria. Figure 1 shows the relationship between $k,l$ and $\rho$ that supports polymorphism of $A$ and $B$, or fixation, for different values of $W$ and $w$. 

\medskip
\centerline{[FIGURE 1 HERE]}
For the simple case of $A1B1$ periodically changing environment we have the following.

\proclaim Result 4. In the case $A1B1$ with $0<\rho<1$ and $0<w<W$ the two fixations are unstable and there exists a unique stable polymorphism.

\noindent{\it Proof}. Let $x$ be the initial frequency of $A$ and $x'$ its frequency  after one cycle of the $A1B1$ selection. Then $x' =F_B\bigl(F_A(x)\bigr)$ where by (8)
$$\eqalign{
&F_A(x)=x{x(1-\rho)(W-w) +\rho W+(1-\rho)w\over x(W-w) +w},\cr\noalign{\smallskip}
&F_B(y) = y{y(1-\rho)(w-W) +\rho w+(1-\rho)W\over y(w-W)+W}.}\eqno(23)$$
The equilibrium equation is $x=F_B\bigl(F_A(x)\bigr)$, which reduces to a fourth degree polynomial equation in $x$. Since the two fixations in $B$ and $A$ are equilibria corresponding to the two solutions $x=0$ and $x=1$, the other equilibria correspond to solutions of a quadratic equation $Q(x) =\alpha_2x^2 +\alpha_1x +\alpha_0=0$ with
$$\alpha_2=1,\quad \alpha_1={W+w\over (2-\rho)(W-w)}-1,\quad \alpha_0={-w\over (2-\rho)(W-w)}.\eqno(24)$$
As $0<\rho<1$ and $0<w<W$ we have
$$Q(0) = {-w\over (2-\rho)(W-w)}<0\eqno(25)$$
and
$$Q(1) ={W\over (2-\rho)(W-w)} >0.\eqno(26)$$
Also, as $\alpha_2=1$ and $\alpha_0<0$, the quadratic equation $Q(x)=0$ has two real roots, one negative and one positive $x^*$ satisfying $0<x^*<1$. The latter determines a unique polymorphism. Let $H(x) =F_B\bigl(F_A(x)\bigr)$. Then 
 $$H(0)=0,\quad H(x^*)=x^*,\quad H(1)=1.\eqno(27)$$
 Also 
 $$F'_A(x) = {x^2(1-\rho)\left(W-w\right)^2 +2xw(1-\rho)(W-w) +w\left[\rho W +(1-\rho)w\right]\over \left[x(W-w) +w\right]^2}\eqno(28)$$
 and
  $$F'_B(x) = {x^2(1-\rho)\left(w-W\right)^2 +2xW(1-\rho)(w-W) +W\left[\rho w +(1-\rho)W\right]\over \left[x(w-W) +W\right]^2}.\eqno(29)$$
  As $0<\rho<1$ and $0<w<W$, we have $F'_A(x)>0$ for  $0\le x\le 1$. Observe that the numerator of $F'_B(x)$ is linear in $\rho$; its value when $\rho=1$ is $wW>0$, and when $\rho=0$ it is
  $$x^2\left(w-W\right)^2 +2xW(w-W) +W^2 =\left[x(w-W) +W\right]^2 >0.\eqno(30)$$
  Hence $F'_{B}(x)>0$ for all $0\le x\le 1$, and $H'(x) =F'_B\bigl(F_A(x)\bigr)F'_A(x)$ is positive when $0\le x\le 1$. Thus $H(x)$ is a monotone increasing function of $x$ for $0\le x\le 1$.
Thus, starting from any initial value $0<x_0 <1$ we have  $x_t\,\harr{}{t\to\infty}\,x^*$. Supplementary Figure S1 illustrates examples of how the frequency of $A$ changes over time in the $A1B1$ regime of cycling selection, while Figure 2A shows the equilibrium frequencies $x^*$ as a function of $\rho$, $W$, and $w$ in this regime.

For more general cyclic fitness regimes, the polynomial that gives the equilibria is of higher order, and it is conceivable that more than one stable polymorphism could exist for given values of $\rho$, $W$, and $w$. We investigated this numerically, and as shown in Supplemental Figure S2, the $A1B2$ regime also appears to allow a single stable polymorphism. For $AkBk$ selection regimes from $k=1$ to $k=40$, Supplemental Figure S3 shows that only a single stable equilibrium appears to exist.
\medskip
\centerline{[FIGURE 2 HERE]}  
 \bigskip
 
 \noindent{\bf RANDOMLY CHANGING ENVIRONMENT}
 \smallskip
 
 We now consider the  case where the environment changes according to a stochastic process. Without loss of generality, assume that the fitness parameters at generation $t$ ($t=0,1,2,\dots$) are $1+s_t$ for phenotype $A$ and $1$ for phenotype $B$, where the random variables $s_t$ for $t=0,1,2,\dots$ are independent and identically distributed. Also we assume that there are positive constants $C$ and $D$ such that $P(-1+C<s_t <D)=1$.
 
 Corresponding to (4), with $w_A=1+s_t$, $w_B=1$ the recursion equation is
 $$x_{t+1}=x_t {1+\rho s_t +x_t(1-\rho)s_t\over 1+x_ts_t}\quad t=0,1,2,\dots\; .\eqno(31)$$
 
\noindent As $\{x_t\}$ for $t=0,1,2,\dots$ is a sequence of random variables, the notion of stability of the two fixation states needs clarification. Following Karlin and Lieberman (1974) and Karlin and Liberman (1975) we make the following definition.
 
 \noindent{\it Definition}: ``stochastic local stability''.
 A constant equilibrium state $x^*$ is said to be {\sl stochastically locally stable} if for any $\var>0$ there exists a $\delta>0$ such that $|x_0-x^*|<\delta$ implies
 $$P\left(\lim_{t\to\infty}x_t =x^*\right)\ge 1-\var.\eqno(32)$$
 Thus stochastic local stability holds for $x^*$ provided for any initial $x_0$ sufficiently near $x^*$ the process $x_t$ converges to $x^*$ with high probability.
 
 In our case there are two constant equilibria $x^*=0$ and $x^*=1$ corresponding to fixation in $B$ and $A$, respectively. We can characterize the stochastic local stability of these fixations as follows.
 
 \proclaim Result 5. Suppose $E\left[\log (1+\rho s_t)\right]>0$. Then $x^*=0$, the fixation of phenotype $B$, is not stochastically locally stable. In fact $P\left(\lim_{t\to\infty}x_t=0\right)=0$.
 
  \proclaim Result 6. Suppose $E[\log(1+\rho s_t)]<0$. Then $x^*=0$, the fixation of phenotype $B$, is stochastically locally stable. In particular, if $E(s_t)\le 0$, $x^*=0$ is stochastically locally stable.
 
 The proofs of Results 5 and  6 can be found in Supplementary Materials SP1 and SP2.
 
 
 Using the general notation for the fitness parameters $w_A$ and $w_B$, the stochastic local stability of the $B$ fixation is determined by the sign of $E\left[\log\left(1-\rho+\rho{w_A\over w_B}\right)\right]$ and that of the $A$ fixation by the sign of $E\left[\log\left(1-\rho+\rho{w_B\over w_A}\right)\right]$. For example, if the first sign  is negative, fixation in $B$ is stochastically locally stable, and when it is positive, with probability one convergence to fixation in phenotype $B$ does not occur. It is also true  that if $E(w_A/w_B)\le 1$, then fixation of $B$ is stochastically locally stable. Following (14),
 $$\left(1-\rho +\rho{w_A\over w_B}\right)\left(1-\rho+\rho{w_B\over w_A}\right) >1.\eqno(33)$$
 Therefore, as in the case of periodically changing environments $AkBl$, it is impossible that both fixations are simultaneously stochastically locally stable.  It is possible, however, that neither fixation is  stochastically locally stable, in which case we expect the population to converge to a polymorphic distribution. Figure 3 illustrates how the properties of $s_t$ in recursion (31) affect the frequency of phenotype $A$, and in particular the stochastic local stability of fixation in phenotype $B$. Figure 4 shows the dynamics of the frequency of $A$ in a case where $w_A$ and $w_B$ are identically distributed and independent; in this case the expectation of the stationary distribution is 1/2, and its variance increases as $\rho$ increases.
\medskip
\centerline{[FIGURES 3, 4 HERE]}  
 \bigskip
 
 \noindent{\bf EVOLUTIONARY STABILITY OF OBLIQUE TRANSMISSION}
 \smallskip
 
 An interesting question concerns the evolution of oblique transmission itself. For example, is there an evolutionarily stable rate of oblique transmission? To answer this question we use a modifier model.
 
 Suppose that the vertical transmission rate is controlled by a genetic locus with two possible alleles $m$ and $M$. Let the vertical transmission rates determined by $m$ and $M$ be $\rho$ and $P$, respectively. Thus there are four pheno-genotypes $mA$, $mB$, $MA$, $MB$ whose frequencies at a given generation are denoted by $x_1$, $x_2$, $x_3$, $x_4$, respectively. As the fitnesses are determined by the two phenotypes $A$ and $B$, and the modifier locus is selectively neutral, we have the following table.
 $$\matrix{
 \hbox{\tenrm pheno-genotype}&mA&mB&MA&MB\cr\noalign{\smallskip}
 \hbox{\tenrm frequency}&x_1&x_2&x_3&x_4\cr\noalign{\smallskip}
 \hbox{\tenrm fitness}&w_A&w_B&w_A&w_B\cr\noalign{\smallskip}
 \hbox{\tenrm vertical transmission rate}&\rho&\rho&P&P\cr}\eqno(34)$$
 Following the rationale leading to equation (2), the next generation pheno-genotype frequencies $x'_1$, $x'_2$, $x'_3$, $x'_4$ are
 $$\eqalign{
 \overline wx'_1 &= w_Ax_1\bigl[(1-\rho)(x_1+x_3) +\rho\bigr] +w_Bx_2(1-\rho)(x_1+x_3)\cr
 \overline wx'_2 &= w_Ax_1(1-\rho)(x_2+x_4) +w_Bx_2\bigl[(1-\rho)(x_2+x_4)+\rho\bigr]\cr 
  \overline wx'_3 &= w_Ax_3\bigl[(1-P)(x_1+x_3) +P\bigr] +w_Bx_4(1-P)(x_1+x_3)\cr
\overline wx'_4 &= w_Ax_3(1-P)(x_2+x_4) +w_Bx_4\bigl[(1-P)(x_2+x_4)+P\bigr], 
}\eqno(35)$$
with $\overline w$, the mean fitness, given by
$$\overline w =w_A(x_1+x_3) +w_B(x_2+x_4).\eqno(36)$$
Starting with a stable equilibrium where only the $m$ allele is present, we check its {\sl external stability} (e.g., Feldman and Liberman 1986; Altenberg et al.\ 2017) to invasion by allele $M$.

Because we assume the initial existence of a stable polymorphic equilibrium that depends on $\rho$ (the rate determined by $m$), we cannot assume a {\sl constant environment}, which always leads to fixation of the favored type, independent of $\rho$. We therefore assume changing environments, and, in particular, the simple case of the $A1B1$ cycling environment, where a unique stable polymorphism exists and depends on $\rho$. Specifically, following (35) with $w_A =W$, $w_B =w$ in the first generation and $w_A=w$, $w_B=W$ in the second generation, after two generations we have
$$\underline x''=T_2(T_1\underline x),\eqno(37)$$
where $\underline x'=T_1\underline x$ is given by (35) with $w_A=W$, $w_B=w$, and $\underline x''=T_2\underline x'$ is given by (35) with $w_A=w$, $w_B=W$. Here $\underline x$, $\underline x'$, $\underline x''$ are the frequency vectors.

For the $A1B1$ case, when only the $m$ allele is present with associated rate $\rho$, with $0<\rho<1$ and $0<w<W$, a unique stable equilibrium $\underline x^* =(x_1^*,1-x_1^*,0,0)$ exists. $x_1^*$ is the only positive root of the quadratic equation $G(x) =\alpha_2x^2 +\alpha_1x +\alpha_0=0$ with $\alpha_2,\alpha_1,\alpha_0$ specified in (24). Solving $G(x)=0$ gives
$$x_1^* ={1\over 2} -{W+w-\sqrt{\left(1-\rho\right)^2\left(W-w\right)^2 +4Ww}\over 2\cdot(2-\rho)(W-w)},\eqno(38)$$
 and it can be seen that
 $${\sqrt{Ww}-w\over W-w}<x_1^* <{1\over 2}.\eqno(39)$$
 
 The external stability of $\underline x^*$ to the introduction of the modifier allele $M$ with rate $P$ is determined by the linear approximation matrix $\cl=\cl_2\cdot\cl_1$ near $x^*$, which is derived from (35) and given by
 $$\overline w^*\cl_1 =\left[\matrix{W\bigl[(1-P)x_1^* +P\bigr] & w(1-P)x_1^*\cr\noalign{\medskip}
 W(1-P)x_2^* & w\bigl[(1-P)x_2^* +P\bigr]\cr}\right]\eqno(40)$$
 and
 $$\overline w^{**}\cl_2 =\left[\matrix{w\bigl[(1-P)x_1^{**} +P\bigr] & W(1-P)x_1^{**}\cr\noalign{\medskip}
 w(1-P)x_2^{**} & W\bigl[(1-P)x_2^{**} +P\bigr]\cr}\right],\eqno(41)$$
where $\underline x^{**} =T_1\underline x^*$, $x_1^{**}=x_2^*=1-x_1^*$, $x_2^{**}=x_1^*$,  and
$$\overline w^* =Wx_1^* +wx_2^*,\qquad \overline w^{**} =wx_1^{**} +Wx_2^{**}.\eqno(42)$$
Due to the symmetry between the two phenotypes $A$ and $B$ in the $A1B1$ case, we have $x_1^{**} =x_2^*$ and $x_2^{**} =x_1^*$ so that $\overline w^{**} =\overline w^*$ and in fact
$$\overline w^*\cl_2 = \left[\matrix{w\bigl[(1-P)x_2^* +P\bigr] & W(1-P)x_2^*\cr\noalign{\medskip}
 w(1-P)x_1^* & W\bigl[(1-P)x_1^* +P\bigr]\cr}\right].\eqno(43)$$
  \smallskip
  
   \noindent{\it Remark}. 
 Observe that as $\underline x^* =T_2(T_1\underline x^*)$ with $x_3^*=x_4^*=0$, from (40) and (41) with $P=\rho$ we have
 $$\left[\matrix{x_1^*\cr\noalign{\medskip} x_2^*\cr}\right]= \cl_2\cdot\cl_1\left[\matrix{x_1^*\cr\noalign{\medskip} x_2^*\cr}\right] =\cl\left[\matrix{x_1^*\cr\noalign{\medskip} x_2^*\cr}\right].\eqno(44)$$
 Hence when $P=\rho$ one of the eigenvalues of $\cl$ is 1.
 \smallskip
 
 In general $\cl=\cl_2\cdot\cl_1$, and using (40) and (43) we get
 $$\eqalign{
 &\left(\overline w^*\right)^2\cl =\cr\noalign{\smallskip}
 &\left[\matrix{Ww\left[(1-P)^2x_1^*x_2^* +P\right] +\bigl[w(1-P)x_1^*\bigr]^2 & W(1-P)\bigl[P+x_1^*(1-P)\bigr]\bigl[Wx_2^* +wx_1^*\bigr]\cr
 \noalign{\medskip}
 w(1-P)\bigl[1-x_1^*(1-P)\bigr]\bigl[Wx_2^* +wx_1^*\bigr] & Ww\left[(1-P)^2x_1^*x_2^* +P\right] +\bigl[W(1-P)x_2^*\bigr]^2
 }\right].}\eqno(45)$$
 The external stability of $\underline x^*$ is determined by the eigenvalues of $\cl$, namely the roots of its characteristic polynomial $R(\lambda) =\det(\cl-\lambda\ci)$, with $\ci$ the $2\times 2$ identity matrix. From (45), $R(\lambda)=a_2\lambda^2 +a_1\lambda +a_0$, where
 $$a_0={P^2W^2w^2\over\left(\overline w^*\right)^4},\qquad a_1=-{2PWw +\left(1-P\right)^2\left[Wx_2^* +wx_1^*\right]^2\over \left(\overline w^*\right)^2},\qquad a_2=1.\eqno(46)$$
 
 We can prove the following result.
 
 \proclaim Result 7. $\cl$ has two positive eigenvalues and\hfil\break
  {\hglue.82truein}(i) when $P>\rho$ the two eigenvalues are less than $1$,\hfil\break
  {\hglue.79truein}(ii) when $P<\rho$ the largest eigenvalue is larger than $1$,\hfil\break
  {\hglue.76truein}(iii) when $P=\rho$, the largest eigenvalue is $1$.\par
  
  \noindent{\it Proof}.  As $\cl$ is a positive matrix by the Perron-Frobenius theory, $\cl$ has a positive eigenvalue, and as $a_0>0$ and $a_2=1$ the product of the two eigenvalues of $\cl$ is positive. Thus in fact $\cl$ has two positive eigenvalues. Let $R(1)=R(1;P)$, then from (46)
  $$R(1;P) = {W^2w^2-\left(\overline w^*\widetilde w^*\right)^2\over\left(\overline w^*\right)^4}P^2 +2P{\left(\widetilde w^*\right)^2 -Ww\over \left(\overline w^*\right)^2} +{\left(\overline w^*\right)^2-\left(\widetilde w^*\right)^2\over\left(\overline w^*\right)^2},\eqno(47)$$
where $\widetilde w^* =Wx_2^* +wx_1^*$.  

By (39) $\bigl(\sqrt{Ww}-w\bigr)/(W-w) <x_1^* <{1\over 2}$, from which it is easily seen that
$$\sqrt{Ww}< \overline w^*<\widetilde w^* .\eqno(48)$$

 When $P=\rho$ one of the eigenvalues of $\cl$ is 1; hence $R(1;\rho)=0$. Another root of $R(1;P)=0$ is $\bigl[(\overline w^*)^2 +\overline w^*\widetilde w^*\bigr]/\bigl[Ww +\overline w^*\widetilde w^*\bigr]$, which by (48) is larger than 1.  As $R(1;0)=\bigl[(\overline w^*)^2 -(\widetilde w^*)^2\bigr]/(\overline w^*)^2 <0$ by (48), we deduce that when $0<P<\rho$, $R(1;P)<0$, whereas when $\rho<P<1$, $R(1;P)>0$.
 Hence, when $P<\rho$, $R(1)<0$, and since $a_2=1$, $R(+\infty)>0$, we conclude that $R(\lambda)=0$ has a positive root larger than 1 and the largest positive eigenvalue of $\cl$ is larger than 1.
 
 When $P>\rho$, we have $R(1)>0$ and also $R(0)=a_0>0$. As $R(\lambda)=0$ has two positive roots and as $a_2>0$, $R(\lambda)$ is convex, either the two positive roots are less than 1 or both larger than one. But the product of the two roots is $P^2W^2w^2/(\overline w^*)^2<1$ by (48); thus when $P>\rho$ the two positive eigenvalues of $\cl$ are less than 1.

It is natural to also ask how the population mean fitness is affected by modification of $\rho$. We have the following result.

\proclaim Result 8. If $W>w$ and $0\le\rho\le 1$, then the mean fitness at the stable equilibrium in the $A1B1$ environment is a decreasing function of $\rho$.\par

\noindent{\it Proof.} In $A1B1$ the stable frequency of phenotype $A$ is by (38)
$$x^* ={1\over 2} -{W+w-Z\over 2(2-\rho)(W-w)},\eqno(49)$$
where $Z =\sqrt{(1-\rho)^2(W-w)^2 +4Ww}>0$.   The mean fitness at the stable equilibrium  is\hfil\break $\overline w^*\cdot\overline w^{**}$, and as $\overline w^* =\overline w^{**}$  by equation (42), this allows us to reduce the problem to properties of $\overline w^*$.  Now since $W>w$,  $\overline w^*$ is an increasing linear function of $x^*$:
$$\overline w^* =x^*W +(1-x^*)w = x^*(W-w) +w.\eqno(50)$$
Thus $\overline w^*$ is decreasing in $\rho$ if $dx^*/d\rho$ is negative. Using (49),
$${dx^*\over d\rho} =- {(1-\rho)(W-w)\over 2(2-\rho)Z} -{W+w-Z\over 2(2-\rho)(W-w)} = {x^*-{1\over 2}\over 2-\rho} -{(1-\rho)(W-w)\over 2(2-\rho)Z}.\eqno(51)$$
From (39) $0<x^*\le{1\over 2}$ and therefore $dx^*/d\rho <0$, which completes the proof.

 We conclude that in the $A1B1$ selection regime an allele $m$ producing vertical transmission rate $\rho$ is stable to the introduction of a modifier allele $M$ with associated rate $P$ if $P>\rho$, and it is unstable if $P<\rho$. Thus in this case, evolution tends to reduce vertical transmission, and hence increase the rate of oblique transmission. The evolutionary dynamics of the reduction in $\rho$ under the $A1B1$ cycling regime are shown in Figure 5, which also illustrates the change in phenotype frequencies over time. In the case of identically distributed random fitnesses $w_A$ and $w_B$, Figure 6 shows  an example of the success of modifiers that reduce $\rho$. 
  
 Figure 2B illustrates the decrease with increasing $\rho$ of the geometric mean fitness (over time) at a polymorphic equilibrium  in the $A1B1$ regime. Figure 7 illustrates an example of the $A1B2$ selection regime: panel A shows the values of selection and $\rho$ that allow polymorphism of phenotypes $A$ and $B$, and Panel B shows that the mean fitness at this equilibrium is decreasing as $\rho$ increases. 
 
 Thus in  cycling fitness  $A1B1$ and  $A2B2$ regimes and the symmetric random fitness regime of Figure 6, there is a {\sl reduction principle} for the rate of vertical transmission (Feldman and Liberman 1986; Altenberg et al.\ 2017). For the $A2B2$ selection regime, numerical analysis (Figure 8) confirms the reduction principle for $\rho$.
  \medskip
\centerline{[FIGURES 5, 6,  7 HERE]}  

 We investigated the dynamics of modifiers of $\rho$ in $AkBk$ regimes for $k\ge 3$. The reduction principle appears to fail for all $k\ge 3$. For each value of $k\ge 3$, there is a value of $\rho$ below which modifiers that increase $\rho$ invade and above which modifiers that reduce $\rho$ invade. For $k\le8$, the evolutionarily stable value of $\rho$, $\rho^*$  increases rapidly with $k$, but then the increase  becomes much slower. Note that for $k$ large enough, during the $Ak$ part of the cycle, phenotype $A$ becomes extremely close to fixation for even moderate values of $w$ relative to $W$. At this stage, any effect of the $M/m$ difference would be very difficult to detect computationally. The variation of $\rho^*$ with $k$ for selection regimes $AkBk$ is shown in Figure 8 for $k\le50$, $W=1$ with $w=0.1$, $0.5$, and $0.9$.
 
 The value of $\rho$ that maximizes the geometric mean fitness, denoted by $\hat\rho$, also varies with $k$ in the $AkBk$ regimes. It is somewhat surprising, given the modifier findings for $k\ge 3$, that $\hat\rho$ is actually zero for $k\le11$ and, depending on the fitnesses, is larger than zero for $k>11$. This is shown in Figure 9, where for $W=1$ with $w=0.1$ and $0.5$, $\hat\rho$ is noticeably positive. For $W=1$, $w=0.9$, however, $\hat\rho=0$ maximizes the geometric mean fitness. More details on the mismatch between $\rho^*$, which cannot be invaded, and $\hat\rho$, which maximizes geometric mean fitness, are given in Supplementary Figure S4. 
\medskip
\centerline{[FIGURES 8, 9 HERE]}  
 \bigskip
 
 \noindent{\bf FINITE POPULATION SIZE}
 \smallskip
 
 In order to include the effect of random drift due to finite population in the above deterministic model, we use the Wright-Fisher model. Let $X_t$ denote the number of individuals with phenotype $A$ in a population of fixed size $N$ at the $t$-th generation, and suppose $X_t=Nx$. Also, let $x'$ represent the frequency of the phenotype $A$ in the infinite population model in the next generation, namely (see (2)),
 $$x'={w_Ax\over\overline w}\rho +(1-\rho)x.\eqno(52)$$
 Then, according to the Wright-Fisher model (Ewens 2004), $X_{t+1}$, the number of individuals of phenotype $A$ at generation $(t+1)$, is determined by the probability
 $$P\bigl(X_{t+1} =j\mid X_t =Nx\bigr) =\left(\matrix{N\cr j\cr}\right)\left(x'\right)^j\left(1-x'\right)^{N-j},\eqno(53)$$
 for $j=0,1,2,\dots,N$.
 Thus the fluctuations in the numbers of phenotypes $A$ and $B$ in the  population of size $N$ are generated by the Wright-Fisher Markov chain process where, given that $X_t=Nx$, $X_{t+1}$ has a binomial distribution with parameters $(N,x')$.
 
 This Markov chain process has two absorbing states, $X_t =N$ and $X_t=0$, corresponding to the two fixations in $A$ and $B$, respectively, and we are interested in the fixation probabilities and the time to fixation of these two absorbing states as functions of the initial frequency $x$ and also of $\rho$, $w_A$, and $w_B$.
 
 To these ends we use a {\sl diffusion approximation}  to the process $\{X_t\}$. Specifically, we compute the mean $\mu(x)$ and the variance $\sigma^2(x)$ of the change in {\sl one generation} in the frequency of phenotype $A$ given that at the beginning of the generation $X_t=Nx$.
 
 To compute $\mu(x)$, observe that by (52)   
 $$\eqalignno{
 x' -x &={w_Ax\over\overline w}\rho +(1-\rho)x -x =\rho x\left[{w_A\over \overline w}-1\right]\cr
 &= \rho x(1-x){w_A -w_B\over w_Ax +w_B(1-x)},&(54)\cr}$$
 since $\overline w =w_A x +w_B(1-x)$.
 For the diffusion approximation, it is essential that the differential selection does not have a large effect per individual in each time period  $\Delta t$ $\bigl(\Delta t\simeq{1\over N}\bigr)$. That is, we assume
 $$w_A\simeq 1+{s_1\over N},\qquad w_B\simeq 1+{s_2\over N}.\eqno(55)$$
 Therefore, up to terms of order smaller than ${1\over N}$,
 $${w_A-w_B\over w_Ax +w_B(1-x)}\simeq {{s_1-s_2\over N}\over 1+ {s_1\over N}x +{s_2\over N}(1-x)} \simeq {s_1 -s_2\over N}.\eqno(56)$$
 Let $s=s_1-s_2$, then
 $$x'-x\simeq {1\over N}\rho sx(1-x)\eqno(57)$$
 up to terms of order small than ${1\over N}$. Since one generation corresponds to $\Delta t\simeq {1\over N}$, we  conclude that
 $$\mu(x) =\rho sx(1-x);\quad 0\le x\le 1.\eqno(58)$$
 
 We now compute $\sigma^2(x)$. From the binomial distribution of $X_{t+1}$ with parameters $N$ and $x'$, the variance of $X_{t+1} -X_t$ given $X_t =Nx$ is $Nx'(1-x')$. Following (52) we have
 $$\eqalignno{
 x'(1-x') &=x\left[{w_A\over \overline w}\rho +(1-\rho)\right](1-x)\left[{w_B\over\overline w}\rho +(1-p)\right]&(59)\cr
 &=x(1-x)\left[{w_Aw_B\over\left(\overline w\right)^2}\rho^2 +{w_A +w_B\over\overline w}\rho(1-\rho) +\left(1-\rho\right)^2\right].&(60)}$$
 Assuming again that $w_A\simeq 1+{s_1\over N}$, $w_B\simeq 1+{s_2\over N}$, up to terms of order smaller than ${1\over N}$ we have
 $${w_A\over\overline w}\simeq 1+{s_1-s_2\over N}(1-x),\qquad {w_B\over\overline w} \simeq 1 +{s_2-s_1\over N}x.\eqno(61)$$
 Consequently
 $$\eqalign{
 {w_A +w_B\over\overline w} &\simeq 2 +{s_1-s_2\over N}(1-2x)\cr\noalign{\smallskip}
 {w_A\cdot w_B\over\left(\overline w\right)^2} &\simeq 1+{s_1-s_2\over N} (1-2x).}
 \eqno(62)$$
 Thus (62) combined with (60) imply that, up to terms of order smaller than ${1\over N}$,
 $$x'(1-x') =x(1-x)\left[1+ \rho{s\over N}(1-2x)\right],\eqno(63)$$
 and the variance, $V$, of the frequency of the phenotype $A$ given that $X_t =Nx$ is
 $$\eqalign{
 V\left({X_{t+1}-X_t\over N}\mid X_t =Nx\right) &={1\over N^2}V\bigl(X_{t+1}\mid X_t=Nx\bigr)\cr \noalign{\smallskip}
 &={x'(1-x')\over N},}\eqno(64)$$
 and in one generation ($\Delta t\simeq{1\over N}$),
 $$\sigma^2(x)\cdot{1\over N} \simeq{1\over N} x(1-x)\left[1 +\rho{s\over N}(1-2x)\right],\eqno(65)$$
 which up to terms of order smaller than ${1\over N}$ gives
 $$\sigma^2(x) =x(1-x).\eqno(66)$$
 
 We  can compute now the fixation probabilities and the expected time to fixation. Let $u(x)$ be the probability of fixation in $A$ given that the initial frequency  of $A$ is $x$, and let $T(x)$ be the expected time until the population becomes fixed if the initial frequency of $A$ is $x$. Then (following, e.g., Karlin and Levikson 1974) we have
 $$u(x) ={\int_0^xs(\eta)d\eta\over\int_0^1s(\eta)d\eta},\ \ \hbox{\tenrm where}\ \ s(\eta)=\exp\left[-\int^\eta{2\mu(\xi)\over\sigma^2(\xi)}d\xi\right],\eqno(67)$$
 and
 $$T(x)=\int_0^1G(x,\xi)d\xi,\eqno(68)$$
 where
 $$G(x,\xi)=\left\{{2u(x)\bigl[u(1) -u(\xi)\bigr]{C\over s(\xi)\sigma^2(\xi)},\quad 0\le x\le\xi\le 1 \atop
 2\bigl[u(1) -u(x)\bigr]u(\xi){C\over s(\xi)\sigma^2(\xi)},\quad 0\le\xi\le x\le 1}\right.\eqno(69)$$
 and $C=\int_0^1s(\eta)d\eta$.
 
 In our case, $\mu(\xi)=\rho s\xi(1-\xi)$ and $\sigma^2(\xi)=\xi(1-\xi)$. Therefore $2\mu(\xi)/
 \sigma^2(\xi) =2\rho s$, $s(\eta) =e^{-2\rho s\eta}$, and it can be easily seen that
 $$u(x) ={1-e^{-2\rho sx}\over 1-e^{-2\rho s}}.\eqno(70)$$
 Now
 $$C=\int_0^1s(\eta)d\eta =\int_0^1e^{-2\rho s\eta}d\eta  ={1-e^{-2\rho s}\over 2\rho s},\eqno(71)$$
Therefore  $T(x)$ is given by
 $$T(x)={1-u(x)\over\rho s}\int_0^x{e^{2\rho s\xi}-1\over \xi(1-\xi)}d\xi +{u(x)\over\rho s}\int_x^1{1-e^{-2\rho s(1-\xi)}\over \xi(1-\xi)}d\xi,\eqno(72)$$
 where $u(x)$ is given in (70), and in generations, $T(x)$ is multiplied by $N$.
  Unfortunately the integrals in (72) cannot be done in closed form unless $\rho s=0$, in which case $u(x)=x$ and $T(x)=-2x\ln x -2(1-x)\ln(1-x)$ (Karlin and Levikson 1974), and only numerical computation of $T(x)$ is possible for specified values of $x$, $\rho$, and $s$.
  
  It is important to note that the fixation probability $u(x)$ is a monotone increasing function of $\rho$ when $s>0$. In fact we have the following result.
  
  \proclaim Result 9. When $s>0$ so that the phenotype $A$ is favored, the fixation probability $u(x)$ is monotone increasing in $\rho$.\par
 
 The proof of Result 9 is in Supplementary Materials SP3.  
  Figure 10 compares the fixation probability and time to fixation derived numerically from  simulating the Wright-Fisher Markov chain with the diffusion-derived values of $u(x)$ and $T(x)$. The fit is seen to be very good. Note that when $N$ is large, the Wright-Fisher model exhibits persistent fluctuation around the deterministic expectation, as shown by the orange diagram in Supplemental Figure S1.
  \medskip
  
  \centerline{[FIGURE 10 HERE]}
 
 We can also develop a diffusion approximation for the case of a cycling environment. Suppose that selection changes in cycles of length $n$ such that within the cycle the fitness parameters are $w_A^t$, $w_B^t$ for $t=1,2,\dots,n$. Also let
 $${1\over N}s_t \simeq w_A^t -w_B^t,\qquad S_t =\sum_{i=1}^t s_i,\qquad t=1,2,\dots,n.\eqno(73)$$
 Following Karlin and Levikson (1974) we have the following result.
 
 \proclaim Result 10. The mean $\mu(x)$ and variance $\sigma^2(x)$ of the change in the frequency of $A$ in one generation for the diffusion approximation in the case of a cycling environment $AkBl$, where $k+l=n$, are
 $$\eqalign{
 \mu(x) &= \rho S_n x(1-x)\cr \sigma^2(x) &= nx(1-x).}\eqno(74)$$
 
 The proof of Result 10, based on induction on $n$, is given in Supplemental Materials SP4.
 
  
 Using the moments in eqs.\ (74), the fixation probability $u(x)$ and the expected time $T(x)$ to fixation can be computed. Comparing to (70) and (72), with $s$  replaced by $S_n/n$, we find
 $$u(x) ={1-e^{-2\rho{S_n\over n}x}\over 1-e^{-2\rho{S_n\over n}}},\eqno(75)$$
 and $T(x)$ can be computed similarly.
 
 In the special case of the $AkBl$ cycling environment, we write $n=k+l$, and if $w_A=W$, $w_B=w$ for $k$ generations, and $w_A=w$, $w_B=W$ for $l$ generations, we have
 $$S_n=S_{k+l} =(k-l)(W-w).\eqno(76).$$
 Figure 11 illustrates how $(k-l)$, $\rho$, and $(W-w)$, which enter the formula for $u(x)$ in (75), interact to affect fixation probabilities.

  
 \medskip
\centerline{[FIGURE 11 HERE]}  
  \bigskip
 
 \noindent{\bf DISCUSSION}
 \smallskip

Non-chromosomal modes of phenotypic transmission are receiving increasing attention (Whiten et al. 2017; Jaenisch and Bird 2003; Allis and Jenuwein 2016), especially with respect to their potential role in adaptation and maintenance of diversity (Rivoire and Leibler 2014). Here we have focused on a dichotomous phenotype transmitted through a combination of parental and non-parental transmission. In addition to the roles that these transmission modes play in the dynamics of phenotypic diversity in large and small populations, we have also investigated a genetic model for the evolution of the transmission mode itself.

Our model differs markedly from that of Xue and Leibler (2016), who took the individual phenotypic distribution (i.e., the probability that an individual develops one of a set of phenotypes) to be the inherited trait. In our model, the transmitted trait is the phenotype itself. Thus, with two phenotypic states $A$ and $B$, we track the frequency $x$ of $A$, whereas Xue and Leibler focus on the dynamics of the per-individual probability $\pi_A$ of learning the phenotype $A$. One interpretation of our model is as a mean-value approximation to the model of Xue and Leibler, where $x$, the state in our model, is the average of the population distribution of individual phenotype probabilities. 

In a constant environment, the higher the vertical transmission rate $\rho$, the faster is the approach to fixation of the favored phenotype: $A$ if $w_A>w_B$ or $B$ if $w_B>w_A$. Here $1-\rho$, the oblique transmission rate, represents the added chance that an offspring becomes $A$ by learning from the parent's population after learning from its parents who have undergone selection (eq.\ 2). This simple phenotypic model does not allow a polymorphism to be achieved in a constant environment, but with more oblique transmission, approach to fixation is retarded.

 With fluctuating environments, the dynamics of the phenotype frequencies are, in general, much more complicated. In particular, with deterministically cycling symmetric fitness values (the $AkBl$ model), it is impossible for fixation in $A$ and $B$ to both be stable. If $k=l$, for example, neither fixation is stable, and from numerical iteration it appears that there is a simple stable polymorphic equilibrium (with phenotypes $A$ and $B$ present; see Result 3). In the $A1B1$ case this  polymorphism is globally stable. In the $AkBl$ case, bounds on $l/k$ that determine the instability of both fixations, and hence the protection of polymorphism are given by inequalities (20), which depend on both the fitness differences and the rate $\rho$ of vertical transmission.
 
 In deterministic one-locus, two-allele diploid population genetic models with cycling fitness regimes, Haldane and Jayakar (1963) first showed the relevance of the geometric mean of genotypic fitnesses (cf.\ inequalities (16) and (17)) for the maintenance (or loss) of polymorphism. However, with equal homozygote fitnesses, which alternated in strength as a two-generation cycle (cf.\ $A1B1$), Karlin and Liberman (1975) extended the Haldane-Jayakar results and found conditions under which both allelic fixations and polymorphic equilibrium could all be stable, with the evolution depending on initial allele frequencies, as well as the homozygote fitness differences between alternate generations. Our haploid model appears not to produce such dependence on the initial conditions.
 
 When the fitnesses $w_A$ and $w_B$ are treated as random variables, rather than varying cyclically, stochastic local stability is the appropriate analog to local stability in the case of cyclic fitness variation. While fixations in phenotypes $A$ and $B$ cannot both be stable in this case, both may be unstable and a polymorphic distribution may result. The variance of this distribution is greater for larger values of $\rho$. This is because the  stochastic local stability conditions involve $E\bigl\{\log[1-\rho+\rho(w_A/w_B)]\bigr\}$ and the effect of the variance of $(w_A/w_B)$ will clearly increase as $\rho$ increases. In the finite population case, a greater level of vertical transmission makes selection more effective, increasing the probability $u(x)$ of fixation and reducing the expected time to fixation.
 
 We have shown that the rate of vertical transmission tends to decrease when it is under the control of a genetic modifier. This is true in the deterministic case with cycling environments, and also in the random selection case, when the fitnesses of $A$ and $B$ are identically distributed and independent between generations. In light of these results, together with the finite population result that fixation probability is higher, and time to fixation faster with greater $\rho$, we can conclude that increased oblique transmission in our model leads to greater phenotypic diversity; i.e., it is more likely to result in  phenotypic polymorphism. This can be seen in Figure 1, where it is also clear that the existence and stability of a polymorphism is more sensitive to $(1-\rho)$ than to the fitness difference between $A$ and $B$.
 
 The mean fitness of the population evaluated at a polymorphism of phenotypes $A$ and $B$ is shown to be an increasing function of the level of oblique transmission in the $A1B1$ (Figure 2B, Figures 5C, 5F, 5I) and $A1B2$ (Figure 7B) environments. We can compare this result with the asymptotic growth rate (AGR) of Xue and Leibler (2016), whose parameter  $\eta$ is the rate at which an individual learns from its parental lineage. For $k$ small enough, the $AkBk$ environment shows the AGR decreasing with $\eta$, but larger values of $k$ entail that the AGR has a maximum for an intermediate value of $\eta$.  [FINISH WRITEUP]





 
\vfil
 \break
 
 \noindent{\bf References}

\ref Allis, C. D., and T. Jenuwein. 2016. The molecular hallmarks of epigenetic control. {\it Nat.\ Rev.\ Genet.} {\bf 17}: 487--500.

\ref Altenberg, L.,  U. Liberman, and M. W. Feldman. 2017. A unified reduction principle for the evolution of mutation, migration, and recombination. {\it Proc.\ Natl.\ Acad.\ Sci.\ USA} {\bf 114}: E2392--E2400.

\ref Aoki, K., and M. W. Feldman. 2014. Evolution of learning strategies in temporally and spatially variable environments: a review of theory. {\it Theor.\ Pop.\ Biol.} {\bf 91}: 3--19.

\ref Aoki, K., J.Y. Wakano, and M. W. Feldman. 2005. The emergence of social learning in
a temporally changing environment: a theoretical model. {\it
Curr.\ Anthropol.} {\bf 46}: 334--340.

\ref Balaban, N. Q., J. Merrin, R. Chait, L. Kowalik, and S. Leibler. 2004. Bacterial persistence as a phenotypic switch. {\it Science} {\bf 305}: 1622--1625.

\ref Bergstrom, C. T., and L. A. Dugatkin. 2012. {\it Evolution}. New York: W. W. Norton \& Co., Inc.

\ref Boyd, R., and P. J. Richerson. 1988. An evolutionary model of social learning: the effect of spatial and temporal variation. Pp. 29--48 {\it in} Zentall, T., and B.G. Galef (eds.) {\it Social Learning}. Hillsdale, NJ: Lawrence Erlbaum Associates, Publishers.

\ref Boyd, R., and P. J. Richerson. 1995. Why does culture increase human adaptability? {\it Ethol.\ Sociobiol.} {\bf 16}: 125--143.

\ref Carja, O., U. Liberman, and  M. W. Feldman. 2014. Evolution in changing environments: modifiers of mutation, recombination, and migration. {\it Proc.\ Natl.\ Acad.\ Sci.\ USA} {\bf 111}: 17935--17940.

\ref Cavalli-Sforza, L. L. and M. W. Feldman.  1981. {\it Cultural
Transmission and Evolution:  A Quantitative Approach}.  Princeton, N.J.: Princeton University
Press.

\ref Ewens, W. 2004. {\it Mathematical Population Genetics}, 2nd Edition. New York: Springer.

\ref Feldman, M. W. and U. Liberman.  1986. An evolutionary reduction
principle for genetic modifiers.  {\it Proc.\ Natl.\ Acad.\ Sci.\ USA} {\bf 83}:
4824--4827.

\ref Feldman, M. W., K. Aoki, and J. Kumm. 1996. Individual
versus social learning:  Evolutionary analysis in a fluctuating environment.   {\it
Anthropological Science} {\bf 104}: 209--231.

\ref Ga\'al, B., J. W. Pitchford, and A. J. Wood. 2010. Exact results for the evolution of stochastic switching in variable asymmetric environments. {\it Genetics} {\bf 184}: 1113--1119.

\ref Haldane, J. B. S., and S. D. Jayakar. 1963. Polymorphism due to selection of varying direction. {\it J. Genet.} {\bf 58}: 237--242.

\ref Jaenisch, R., and A. Bird. 2003. Epigenetic regulation of gene expression: how the genome integrates intrinsic and environmental signals. {\it Nat.\ Genet.} {\bf 33}: 245--254.

\ref Karlin, S., and B. Levikson. 1974. Temporal fluctuation in selection intensities: case of small population size. {\it Theor.\ Popul.\ Biol.} {\bf 6}: 383--412.

\ref Karlin, S., and U. Lieberman. 1974. Random temporal variation in selection intensities: case of large population size. {Theor.\ Popul. Biol.} {\bf 6}: 355--382.

\ref Karlin, S., and U. Liberman. 1975. Random temporal variation in selection intensities: one-locus two-allele model. {\it J. Math.\ Biol.} {\bf 2}: 1--17.

\ref Lederberg, J., and E. L. Tatum. 1946. Gene recombination in {\it Escherichia coli}. {\it Nature} {\bf 158}: 558.

\ref Liberman, U., J. Van Cleve, and M. W. Feldman. 2011. On the evolution of mutation in changing environments: recombination and phenotypic switching. {\it Genetics}  {\bf 187}: 837--851.

\ref Lycett, S. J., and J. A. J. Gowlett. 2008. On questions surrounding the Acheulean `tradition'. {\it World Archaeol.} {\bf 40}: 295--315.

\ref Mazel, D. Integrons: agents of bacterial evolution. {\it Nat.\ Rev.\ Microbiol.} {\bf 4}: 608--620.

\ref Milkman, R., and M. M. Bridges. Molecular evolution of the {\it Escherichia coli} chromosome. III. Clonal frames. {\it Genetics} {\bf 126} 505--517.

\ref Redfield, R. J. Evolution of natural transformation: testing the DNA repair hypothesis in {\it Bacillus subtilis} and {\it Haemophilus influenzae}. {\it Genetics} {\bf 133}: 755--761.

\ref Rivoire, O., and S. Leibler. 2014. A model for the generation and transmission of variations in evolution. {\it Proc.\ Natl.\ Acad.\ Sci.\ USA} {\bf 111}: E1940--E1949.

\ref Rogers, A. R. 1988. Does biology constrain culture? {\it Am.\ Anthropol.} {\bf 90}: 819--831.

\ref Rosenberg, E., and I. Zilber-Rosenberg. 2016. Microbes drive evolution of animals and plants: the hologenome concept. {\it mBio} {\bf 7}: e01395-15.

\ref Salath\'e, M., J. Van Cleve, and M. W. Feldman. 2009. Evolution of stochastic switching rates in asymmetric fitness landscapes. {\it Genetics} {\bf 182}: 1159--1164.

\ref Salyers, A. A., G. Whittle, and N. B. Shoemaker. 2004. Conjugal and mobilizable transposons. Pp./ 125--143 {\it in} Miller, R., and M. Day (eds.) {\it Microbial Evolution}. Washington, D.C.: ASM Press.

\ref Thattai, M., and A. van Oudenaarden. 2004. Stochastic gene expression in fluctuating environments. {\it Genetics} {\bf 167}: 523--530.

\ref Theis, K. R., N. M. Dheilly, J. L. Klassen, R. M. Brucker, J. F. Baines, T. C. G. Bosch, J. F. Cryan, S. F. Gilbert, C. J. Goodnight, E. A. Lloyd, J. Sapp, P. Vandenkoornhuyse, I. Zilber-Rosenberg, E. Rosenberg, and S. R. Bordenstein. 2016. Getting the hologenome concept right: an eco-evolutionary framework for hosts and their microbiomes. {\it mSystems} {\bf 1}: e00028-16.

\ref van Opstal, E. J., and S. R. Bordenstein. 2015. Rethinking heritability of the microbiome. {\it Science} {\bf 349}: 1172--1173.

\ref Wakano, J. Y., and K. Aoki. 2007. A mixed strategy model for the emergence and intensification of social learning in a periodically changing natural environment. {\it Theor.\ Popul.\ Biol.} {\bf 70}: 486--497.

\ref Wakano, J. Y., K. Aoki, and M. W. Feldman. 2004. Evolution of social learning: a
mathematical analysis. {\it Theor.\ Pop.\ Biol.} {\bf 66}: 249--258.

\ref Whiten, A., F. Ayala, M. W. Feldman, and K. N. Laland. 2017. The extension of biology through culture. {\it Proc.\ Natl.\ Acad.\ Sci.\ USA} {\bf 114}: 7775--7781.

\ref Xue, B.-K., and S. Leibler. 2016. Evolutionary learning of adaptation to varying environments through a transgenerational feedback. {\it Proc.\ Natl.\ Acad.\ Sci.\ USA} {\bf 113}: 11266--11271.

\ref Zinder, N. D., and J. Lederberg. 1952.  Genetic exchange in {\it Salmonella}. {\it J. Bacteriol.} {\bf 64}: 679--699.
 \vfil
 \break
 \centerline{\bf TABLE 1}
 \smallskip
 
 $$\vbox{\halign{\hfil #&&\qquad\hfil#\hfil\cr
 &&&&evolutionarily&fitness\cr
 &&&&stable&optimal\cr
 &$k$&$l$&$w$&$\rho^*$&$\hat\rho$\cr
 0&3&10&0.1&0.5286296&0.01010101\cr
 1&5&30&0.1&0.24641176&0.01010101\cr
 2&3&10&0.5&0.38577372&0.02020202\cr
 3&5&30&0.5&0.46443287&0.01010101\cr
 4&3&10&0.9&0.9681569&0.05050505\cr
 5&5&30&0.9&0.64959375&0.02020202\cr
6&12&12&0.1&0.84855774&0.24242424\cr
7&30&30&0.5&0.96077135&0\cr
8&1&1&0.1&0&0\cr
9&1&2&0.1&0&0.01010101\cr
10&2&2&0.1&0.00015691&0\cr
11&1&1&0.5&0&0\cr
12&1&2&0.5&0&0.22222222\cr
13&2&2&0.5&5.68E-05&0\cr
14&1&1&0.9&0&0\cr
15&1&2&0.9&0&0.36363636\cr
16&2&2&0.9&5.06E-05&0\cr}}$$
 \vfil\break
 
 
 \centerline{\bf SUPPLEMENTAL MATERIALS}
 \bigskip
 
 \noindent{\bf SP1. Proof of Result 5}
 \medskip
 
 \noindent{\it Proof of Result 5}. Rewrite recursion (31) as
 $${x_t+1\over x_t} =(1+\rho s_t)\left[1-x_t{\rho s_t(1+s_t)\over (1+\rho s_t)(1+x_ts_t)}\right].\eqno(\hbox{\tenrm S}1)$$
 Then
 $$\log x_{t+1} -\log x_t =\log(1+\rho s_t) +\log\left[1-x_t{\rho s_t(1+s_t)\over (1+\rho s_t)(1+x_ts_t)}\right].\eqno(\hbox{\tenrm S}2)$$
 Summation yields
 $${1\over t}\left[\log x_t-\log x_0\right] ={1\over t}\sum_{n=0}^{t-1}\log(1+\rho s_n) +{1\over t}\sum_{n=0}^{t-1}\log\left[1-x_n{\rho s_n(1+s_n)\over (1+\rho s_n)(1+x_ns_n)}\right].\eqno(\hbox{\tenrm S}3)$$
Let $\mu=E\left[\log(1+\rho s_t)\right]$. As $\{s_t\}_{t\ge 0}$ are independent and identically distributed random variables, the {\sl strong law of large numbers} applies and
$$\lim_{t\to\infty}{1\over t}\sum_{n=0}^{t-1}\log(1+\rho s_n)=\mu\eqno(\hbox{\tenrm S}4)$$
almost surely.

Let $\zeta$ be such that ${1\over t}\sum_{n=0}^{t-1}\log[1+\rho s_n(\zeta)]=\mu$ and assume that $\lim_{t\to\infty}x_t(\zeta)=0$. As the random variables $\{s_t\}_{t\ge 0}$ are uniformally bounded,
$$x_t(\zeta){\rho s_t(\zeta)[1+s_t(\zeta)]\over [1+\rho s_t(\zeta)][1+x_t(\zeta)s_t(\zeta)]}\;\;\harr{}{t\to\infty}\;\;0\eqno(\hbox{\tenrm S}5)$$
and
$$\lim_{t\to\infty}{1\over t}\sum_{n=0}^{t-1}\log\left[1-x_n(\zeta){\rho x_n(\zeta)[1+s_n(\zeta)]\over [1+\rho s_n(\zeta)][1+x_t(\zeta)s_n(\zeta)]}\right]=0.\eqno(\hbox{\tenrm S}6)$$
Thus (S3) implies that
$$\lim_{t\to\infty}{1\over t}\left[\log x_t(\zeta) -\log x_0(\zeta)\right]=\mu.\eqno(\hbox{\tenrm S}7)$$
If $\mu =E\left[\log(1+s_t)\right]>0$, then from (S7) we deduce that $\lim_{t\to\infty}x_t(\zeta)=\infty$, a contradiction.
Therefore when $\mu>0$, $P\left(\lim_{t\to\infty}x_t=0\right)=0$, and fixation of $B$ ($x^*=0$) is stochastically locally unstable.

 Thus by Result 5, for $x^*=0$ to be stochastically locally stable it is necessary that $E[\log(1+\rho s_t)]\le 0$. In fact, the strict inequality is sufficient.
 
 Figure 3 presents a numerical example of the dynamics of recursion (31) with a specific random selection coefficient $s_t$.
\bigskip
\bigskip

 \noindent{\bf SP2. Proof of Result 6}
 \medskip

Let $\mu=E[\log(1+\rho s_t)]$. Then as $\{s_t\}_{t\ge 0}$ are independent and identically distributed random variables, the strong law of large number applies and almost surely
 $$\lim_{t\to\infty}{1\over t}\sum_{n=0}^{t-1}\log(1+\rho s_n)=\mu<0.\eqno(\hbox{\tenrm S}8)$$
 Appealing to the Egoroff Theorem, for any $\var>0$ there exists $T$ such that 
 $$P\left({1\over t}\sum_{n=0}^{t-1}\log(1+\rho s_n)<{\mu\over 2}\ \hbox{\tenrm for all}\ t\ge T\right)\ge 1-\var.\eqno(\hbox{\tenrm S}9)$$
 As $0\le \rho\le 1$ and the $\{s_t\}_{t\ge 0}$ are uniformly bounded, we can find a $\delta'>0$ such that
 $$x_t<\delta'\Longrightarrow\left|\log\left[1-x_t{\rho s_t(1+s_t)\over (1+\rho s_t)(1+x_ts_t)}\right]\right|<-{\mu\over 4}.\eqno(\hbox{\tenrm S}10)$$
 Also, as $0\le x_t\le 1$ for all $t$,
 $$x_{t+1}=x_t{1+\rho s_t +x_t(1-\rho)s_t\over 1+x_ts_t}< Kx_t,\eqno(\hbox{\tenrm S}11)$$
 where $K$ is independent of $t$. It follows that there exists a $\delta$ with $0<\delta<\delta'$ such that
 $$x_o<\delta\Longrightarrow x_t<\delta'\ \hbox{\tenrm for all}\ t=0,1,2,\dots,T-1.\eqno(\hbox{\tenrm S}12)$$
 Let $\xi$ be a realization of the evolutionary process such that
 $${1\over t}\sum_{n=0}^{t-1}\log[1+\rho s_n(\xi)]<{\mu\over 2}\ \hbox{\tenrm for all}\  t\ge T\eqno(\hbox{\tenrm S}13)$$
 and assume $x_0<\delta$. Then
 $$\eqalign{
 {1\over T}&[\log x_T(\xi) -\log x_0(\xi)] \cr
 &={1\over T}\sum_{n=0}^{T-1}\log[1+\rho s_n(\xi)]+{1\over T}\sum_{n=0}^{T-1}\log[1-x_n(\xi){\rho s_n(\xi)[1+s_n(\xi)]\over [1+\rho s_n(\xi)][1+x_n(\xi)s_n(\xi)]}\cr\noalign{\smallskip}
 &<{\mu\over 2}- {\mu\over 4} ={\mu\over 4}<0, }\eqno(\hbox{\tenrm S}14)$$
 and therefore $x_T(\xi) <x_0(\xi) <\delta'$. Invoking induction we get that for $t\ge T$
 $${1\over t}\log{x_t(\xi)\over x_0}\le {\mu\over 4},\eqno(\hbox{\tenrm S}15)$$
 or for all $t\ge T$
 $$x_t(\xi)\le x_0\exp\left({\mu\over 4}t\right).\eqno(\hbox{\tenrm S}16)$$
 
 As $\mu<0$, this implies that $x_t(\xi)\,\harr{}{t\to\infty}\,0$. Therefore we have shown that for given $\var>0$ there is a $\delta>0$ such that if $0<x_0<\delta$, then $P\left(\lim_{t\to\infty}x_t =0\right)\ge 1-\var$, and therefore $x^*=0$, the fixation in $B$ is stochastically locally stable. The second statement of Result 5 follows from the convexity of the log function and Jensen's inequality.
\bigskip
\bigskip

 \noindent{\bf SP3. Proof of Result 9}
 \medskip

Without loss of generality and for the ease of representation, we will show that for $t>0$, 
  $$v (x;t) ={1-e^{-tx}\over 1-e^{-t}}\eqno(\hbox{\tenrm S}17)$$
  is monotone increasing as a function of $t$. Observe that
  $${\partial v\over\partial t} = {\left(1-e^{-t}\right)xe^{-tx} -\left(1-e^{-tx}\right)e^{-t}\over \left(1-e^{-t}\right)^2}.\eqno(\hbox{\tenrm S}18)$$
  
   \noindent For the monotonicity we have to show that
  $$f(x;t) =\left(1-e^{-t}\right)xe^{-tx} -\left(1 -e^{-tx}\right)e^{-t} \ge 0\eqno(\hbox{\tenrm S}19)$$ 
  when $t>0$ and $0\le x\le 1$. Note that $f(0;t)=0$ and $f(1;t)=0$. Also
  $${\partial f\over\partial x} =\left(1-e^{-t}\right)\left(e^{-tx}-txe^{-tx}\right) -te^{-tx}e^{-t},\eqno(\hbox{\tenrm S}20)$$
  or
  $${\partial f\over\partial x} =e^{-tx}\left[\left(1-e^{-t}\right)\left(1-tx\right) -te^{-t}\right] =e^{-tx}g(x;t),\eqno(\hbox{\tenrm S}21)$$
 say, where for fixed $t$, $g(x;t)$ is a linear function of $x$, which vanishes at $x_0 =(1-e^{-t} -te^{-t})/t(1-e^{-t})$. If $t>0$, $e^t >1+t$, so $1>e^{-t}(1+t)$ and $x_0>0$. Also if $t>0$, $e^{-t}>1-t$, and so $1-e^{-t} -te^{-t} <t(1-e^{-t})$ and $x_0<1$. Since $g(0,t) =1 -e^{-t} -te^{-t} >0$ and $g(1;t) =(1-e^{-t})(1-t) -te^{-t} <0$ for $t>0$, we deduce that ${\partial f\over\partial x}(x,t)>0$ for $ 0<x<x_0$ and ${\partial f\over\partial x}(x,t)<0$ for $x_0<x<1$ for all $t>0$. These facts, combined with $f(0,t) =f(1;t) =0$, prove that $f(x;t)\ge 0$ for $0\le x\le 1$ (in fact, $f(x;t)>0$ for $0<x<1$), and inequality (S19) is satisfied as desired.
\bigskip
\bigskip

 \noindent{\bf SP4. Proof of Result 10}
 \medskip

 The proof is based on induction on $n$, where in order to prove (74), we show that if $X_t$ is the number of individuals with phenotype $A$ at stage $t$ of the cycle, and $x$ is the initial frequency of $A$, then
 $$E\left({X_t\over N} -x\right) \simeq {1\over N}\rho S_t x(1-x),\qquad V\left({X_t\over N}\right)\simeq {1\over N}tx(1-x),\eqno(\hbox{\tenrm S}22)$$
 where $N$ is the size of the population. When $t=1$, (S22) coincides with the constant environment case. Assuming (S22), we go to $t+1$. Now $X_{t+1}$ given $X_t=Ny$ has a binomial distribution with parameters $(N,y')$. Hence
 $$E\left({X_{t+1}\over N} -{X_t\over N} \mid X_t=Ny\right) =y'-y.\eqno(\hbox{\tenrm S}23)$$
 Following (57), $y'-y\simeq (1/N)\rho s_{t+1}y(1-y)$, and so
 $$E\left({X_{t+1}\over N} -{X_t\over N}\mid X_t\right)\simeq {1\over N}\rho s_{t+1}{X_t\over N}\left(1-{X_t\over N}\right).\eqno(\hbox{\tenrm S}24)$$
 Observe that
 $$\eqalign{
 E\left[{X_t\over N}\left(1-{X_t\over N}\right)\right] &= E\left({X_t\over N}\right) -E\left[\left({X_t\over N}\right)^2\right]\cr\noalign{\smallskip}
    &= E\left({X_t\over N}\right) -V\left({X_t\over N}\right) -\left[E\left({X_t\over N}\right)\right]^2.\cr}\eqno(\hbox{\tenrm S}25)$$
 By the induction assumption, $V(X_t/N)\simeq (1/N)tx(1-x)$, and ignoring terms of order $1/N^2$ we have
 $$E\left({X_{t+1}\over N} -{X_t\over N}\right)\simeq {1\over N}\rho s_{t+1} E\left({X_t\over N}\right)\left[1-E\left({X_t\over N}\right)\right].
\eqno(\hbox{\tenrm S}26)$$
Applying (S22) we have
$$\eqalign{
E\left({X_t\over N}\right)  &\simeq x+{1\over N}\rho S_tx(1-x)\cr\noalign{\smallskip}
1-E\left({X_t\over N}\right) &\simeq 1-x-{1\over N}\rho S_tx(1-x),} \eqno(\hbox{\tenrm S}27)$$
and ignoring terms $O(1/N^2)$, we find
$$E\left({X_{t+1}\over N} -{X_t\over N}\right) \simeq {1\over N}\rho s_{t+1}x(1-x).\eqno(\hbox{\tenrm S}28)$$
Thus
$$\eqalign{
E\left({X_{t+1}\over N} -x\right) &= E\left({X_{t+1}\over N} -{X_t\over N}\right) +E\left({X_t\over N} -x\right)\cr\noalign{\smallskip}
&\simeq {1\over N}\rho s_{t+1}x(1-x) +{1\over N}\rho S_t x(1-x),}\eqno(\hbox{\tenrm S}29)$$
and since $S_t +s_{t+1} =S_{t+1}$,
 $$E\left({X_{t+1}\over N} -x\right)\simeq	{1\over N}\rho S_{t+1}x(1-x)\eqno(\hbox{\tenrm S}30)$$
 as desired.
 

 We now compute $V(X_{t+1}/N)$ using the induction assumption and the formula
 $$V\left({X_{t+1}\over N}\right) =E\left[V\left({X_{t+1}\over N}\mid X_t\right)\right] +V\left[E\left({X_{t+1}\over N}\mid X_t\right)\right],\eqno(\hbox{\tenrm S}31)$$
 where by (S22)
 $$E\left({X_{t+1}\over N}\mid X_t\right)\simeq {X_t\over N} +{1\over N}\rho s_{t+1}{X_t\over N}\left(1-{X_t\over N}\right)\eqno(\hbox{\tenrm S}32)$$
 and
 $$V\left({X_{t+1}\over N}\mid X_t\right)\simeq{1\over N}{X_t\over N}\left(1-{X_t\over N}\right).\eqno(\hbox{\tenrm S}33)$$
 Here we used the fact that by (63) $y'(1-y')\simeq y(1-y)$. Now
 $$E\left[V\left({X_{t+1}\over N}\mid X_t\right)\right] \simeq {1\over N}E\left[{X_t\over N}\left(1-{X_t\over N}\right)\right]\simeq {1\over N}x(1-x),\eqno(\hbox{\tenrm S}34)$$
 where we use the same computations as led from (S25) to (S28).
 $$V\left[E\left({X_{t+1}\over N}\mid X_t\right)\right] =V\left[{X_t\over N} +{1\over N}\rho s_{t+1}{X_t\over N}\left(1-{X_t\over N}\right)\right].\eqno(\hbox{\tenrm S}35)$$
 Since $(X_t/N)\bigl[1-(X_t/N)\bigr]$ is a random variable taking values in [0,1],  its variance is less than 1/4 and
 $$V\left[{1\over N}\rho s_{t+1}{X_t\over N}\left(1-{X_t\over N}\right)\right] \le {1\over 4N^2}\rho^2 s_{t+1}^2.\eqno(\hbox{\tenrm S}36)$$
 We ignore terms $O(1/N^2)$ so that the random variable $(1/N)\rho s_{t+1}(X_t/N)\bigl[1-(X_t/N)\bigr]$ is almost constant. As a result,
 $$V\left[E\left({X_{t+1}\over N}\mid X_t\right)\right]\simeq V\left({X_t\over N}\right) \simeq {1\over N}tx(1-x),\eqno(\hbox{\tenrm S}37)$$
 by the induction assumption. Combining (S34) and (S37) gives
 $$V\left({X_{t+1}\over N}\right)\simeq {1\over N}x(1-x) +{1\over N}tx(1-x) ={1\over N}(t+1)x(1-x)\eqno(\hbox{\tenrm S}38)$$
 as expected.
 
 
 \end\bye


