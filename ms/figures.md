![Ratios of selection periods $\frac{l}{k}$ that lead to fixation of phenotype _B_ (red) or polymorphism between phenotypes _A_ and _B_ (blue). _l_ and _k_ are the number of generations in which phenotypes _B_ and _A_ are favored by selection. Parameters: _W_ = 1.](figures/lk_phase_plane.pdf){#fig:lk_phase_plane}

![Frequency of phenotype _A_ after every two generation in selection regime _A1B1_. Comparison of the finite population model (orange; average of 100 simulations), the infinite population model (blue; @eq:recurrenceA1B1), and the equilibrium solution (dashed green; @eq:recurrenceA1B1_solution_x_star). Parameters: _W_=1, _N=10,000_, initial value $x=0.5$.](figures/env_A1B1.pdf){#fig:env_A1B1}

![Consecutive fixation of modifiers that reduce the vertical transmission rate in environmental regime _A1B1_. The figure shows results of numerical simulations of evolution with two modifier alleles (@eq:recurrence_modifiers). When a modifier allele fixes (frequency>99.9%), a new modifier allele is introduced with a vertical transmission rate one order of magnitude lower (vertical dashed lines). **(A,E,I)** The frequency of phenotype _A_ in the population over time. **(B,F,J)** The frequency of the invading modifier allele over time. **(C,G,K)** The population mean vertical transmission rate over time. **(D, H, L)** The population mean fitness over time; insets zoom in to show that the mean fitness slightly decreases with each invasion. Parameters: Vertical transmission rate of the initial resident modifier allele, $\rho_0 =0.1$; fitness values: _W_=1, _w_=0.1 (**A-D**), 0.5 (**E-H**), and 0.9 (**I-L**). The x-axis is in log-scale, as each sequential invasion takes an order of magnitude longer to complete.](figures/A1B1_modifier_invasions.pdf){#fig:A1B1_modifier_invasions}

![Stable frequency of phenotype _A_ (@eq:recurrenceA1B1_solution_x_star) in selection regime _A1B1_ as a function of the vertical transmission rate $\rho$ and the fitness ratio $W/w$ between the favored and unfavored phenotypes. Parameters: _W=1_.](figures/A1B1_stable_x.pdf){#fig:A1B1_stable_x}

![Stable mean fitness in selection regime _A1B1_ as a function of the vertical transmission rate $\rho$ and the fitness ratio $W/w$ between the favored and unfavored phenotypes. Parameters: _W=1_.](figures/A1B1_mean_fitness.pdf){#fig:A1B1_mean_fitness}


![Frequency of phenotype _A_ after every three generation in selection regime _A1B2_. Comparison of dynamics starting with different initial frequency of phenotype $A$ (0.01-0.99). Fixation is determined if the final population in 100 simulations with finite population size $N$ had 0 frequency of $A$ at the end f the run. For a general view on fixation vs. polymorphism, see @Fig:lk_phase_plane and @Fig:A1B2_polymorphism_x. Parameters: _W_=1, _N=10,000_, initial population $x=0.5$.](figures/env_A1B2.pdf){#fig:env_A1B2}

![Stable frequency of phenotype _A_ in selection regime _A1B2_ as a function of the vertical transmission rate $\rho$ and the fitness ratio $W/w$ between the favored and unfavored phenotypes. In the grey area $B$ reached fixation and the frequency of $A$ is 0. Parameters: _W=1_.](figures/A1B2_polymorphism_x.pdf){#fig:A1B2_polymorphism_x}

![Stochastic local stability. The figure shows the frequency of phenotype _A_ after $10^6$ generations in a very large population evolving in a stochastic environment (@eq:recurrence_random_env). The fitness of phenotypes _A_ and _B_ are $1+s_t$ and $1$, where $s_t$ is _s_ with probability _p_ and _-s_ with probability _1-p_. The white line marks combinations of _p_ and _s_ for which $\mathbb{E}[\log{(1+\rho s_t)}]=0$; according to our analysis, we expect that  below this line $x^*=0$ will be stochastically locally stable. Parameters: $x_0=0.1$; $\rho=0.1$](figures/stochastic_env_x_t.pdf){#fig:stochastic_env_x_t}


![Consecutive fixation of modifiers that reduce the vertical transmission rate under randomly changing selection. The figure shows results of numerical simulations of evolution with two modifier alleles (@eq:recurrence_modifiers). When a modifier allele fixes (frequency>99.9%), a new modifier allele is introduced with a vertical transmission rate one order of magnitude lower (vertical dashed lines). **(A)** The frequency of phenotype _A_ in the population over time. **(B)** The frequency of the invading modifier allele over time. **(C)** The population mean vertical transmission rate over time. Vertical transmission rate of the initial resident modifier allele, $\rho_0 =0.1$; fitness values: _W=1_ and _w=0.1_ with probability 0.5 and _W=0.1_ and _w=1_ otherwise. The x-axis is in log-scale, as each sequential invasion takes an order of magnitude longer to complete.](figures/stoch_modifier_invasions.png){#fig:stoch_modifier_invasions}

![Effect of vertical transmission rate of phenotype polymorphism in randomly changing environments. Change in frequency of phenotype $A$ over time when the fitness of phenotypea $A$ and $B$ are identically and independently distributed random variable when starting at $x_0=10^{-5}$. As the vertical transmission rate $\rho$ increases from 0.001 to 0.5 the frequency reaches $x= \approx 0.5$ faster, but the variance also increases. $w_A$ and $w_B$ are both exponential random variables with expected value 2.](figures/stoch_two_iid_rvs.png){#fig:stoch_two_iid_rvs}

![Fixation probability and time in a finite population. **(A)** Fixation probability of phenotype $A$ and **(B)** Expected time for fixation of phenotype $A$, conditioned on its fixation, starting with a single copy in a population of size $N$. The figure compares three estimations: simulations (blue circles); diffusion equation approximation (green solid line); and standard population genetics theory (red dashed line) - assuming large population, weak selection, and that oblique transmission only decreases selection efficiency. Parameters: Selection coefficient, $s=w_A-w_B=0.1$; Population size, $N=10,000$.](figures/fixation_prob_time.pdf){#fixation_prob_time}
